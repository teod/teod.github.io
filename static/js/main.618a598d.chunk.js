(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"fetchCompany",function(){return U});var r={};a.r(r),a.d(r,"saveUserReview",function(){return D});var i=a(0),c=a.n(i),o=a(53),s=a.n(o),l=(a(76),a(16)),u=a(10),m=a(130),v=a(63),d=a(5),p={data:[{id:1,username:"Anonym",rating:4,review:"Liked it very much - probably one of the best thai restaurants in the city",time:"2019-02-24T12:32:01.985Z",referral:"hitta.se"},{id:2,username:"Jenny Svensson",rating:4,review:"Maybe a bit too fast food. I personnaly dislike that. Good otherwise",time:"2019-02-24T14:32:01.985Z",referral:"hitta.se"},{id:3,username:"happy56",rating:5,review:"Super good! Love the food!",time:"2019-02-24T20:32:01.985Z",referral:"yelp.com"}],userReview:{rating:null,username:null,description:null,time:null,isSaved:!1,apiSaved:!1,referral:"hitta.se"}},h={data:null},f=Object(u.combineReducers)({reviews:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"reviews/UPDATE_USER_REVIEW":return Object(d.a)({},e,{userReview:Object(d.a)({},e.userReview,t.data,{isSaved:!1})});case"reviews/SAVE_USER_REVIEW":return Object(d.a)({},e,{userReview:Object(d.a)({},e.userReview,t.data)});case"reviews/SAVE_USER_REVIEW_SUCCESS":return Object(d.a)({},e,{userReview:Object(d.a)({},e.userReview,{time:(new Date).toISOString(),isSaved:!0,apiSaved:!0})});default:return e}},company:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"company/FETCH_SUCCESS":var a=t.data;return Object(d.a)({},e,{data:a});default:return e}}}),E=a(68),b=a(131),g=a(70),w=a(69),y=a(128),R=a(41),O=a(129),j=a(45),S=a(26),C=a.n(S),N=function(e){var t=e.headers.get("Content-Type"),a=t&&-1!==t.indexOf("application/json");if(e.ok)return a?e.json():C()();if(a)return e.json().then(function(e){throw Error(JSON.stringify(e))});throw Error(JSON.stringify(e))},U=function(e){return e.pipe(Object(w.a)("company/FETCH"),Object(y.a)(function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=fetch(e,{headers:Object(d.a)({},{Accept:"application/json"},t)}).then(N);return Object(j.a)(a)}("https://api.hitta.se/search/v7/app/company/VdgWZZ___C").pipe(Object(R.a)(function(e){return function(e){return{type:"company/FETCH_SUCCESS",data:e}}(e.result.companies.company[0])}),Object(O.a)(function(e){return Object(g.a)((e.message,{type:"company/FETCH_FAILURE"}))}))}))},I=a(66),_=a(44),k=a(64),A=a.n(k),T=a(65),V=a.n(T),D=function(e,t){return e.pipe(Object(w.a)("reviews/SAVE_USER_REVIEW"),Object(I.a)(function(e){var t=e.data,a=t.username,n=t.description;return function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=fetch(e,{method:"POST",headers:Object(d.a)({},{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-HITTA-DEVICE-NAME":"MOBILE_WEB","X-HITTA-SHARED-IDENTIFIER":0x35f609546d799c},a),body:t}).then(N);return Object(j.a)(n)}("https://test.hitta.se/reviews/v1/company",function(e){var t=[];for(var a in e)if(e[a]){var n=encodeURIComponent(a),r=encodeURIComponent(e[a]);t.push(n+"="+r)}return t.join("&")}({userName:a,score:t.rating,comment:n,companyId:"VdgWZZ___C"})).pipe(Object(R.a)(function(){return Object(_.confirmAlert)({title:"Thank you for your review",message:"You're helping others make smarter decisions every day.",buttons:[{label:"Okay!",onClick:void 0}]}),{type:"reviews/SAVE_USER_REVIEW_SUCCESS"}}),Object(O.a)(function(e){return Object(g.a)((e.message,{type:"reviews/SAVE_USER_REVIEW_FAILURE"}))}))}))},x=Object.values(Object(d.a)({},n,r)),W=b.a.apply(void 0,Object(E.a)(x)),F=a(13),M=a(14),Z=a(17),H=a(15),B=a(18),L=function(e){function t(){return Object(F.a)(this,t),Object(Z.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchCompany()}},{key:"render",value:function(){var e=this.props.data;return e?c.a.createElement("h1",null,e.displayName):null}}]),t}(i.Component),J={fetchCompany:function(){return{type:"company/FETCH"}}},Y=Object(l.b)(function(e){return{data:e.company.data}},J)(L),z=a(57),P=a.n(z),X=(a(122),a(67)),G=a.n(X),K=(a(123),function(e){var t=e.children,a=e.visible,n=void 0!==a&&a,r=e.onClose,i=void 0===r?C.a:r,o=e.onSave,s=void 0===o?C.a:o;return c.a.createElement("div",{className:G()("modal",{visible:n})},c.a.createElement("div",{className:"header flex mb20"},c.a.createElement("div",{className:"headerButton",onClick:i},"Close"),c.a.createElement("div",{className:"headerButton",onClick:s},"Save")),t)}),$=(a(124),function(e){function t(){var e,a;Object(F.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object(H.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",description:""},a.onUsernameChange=function(e){var t=e.target.value;a.setState(function(){return{username:t}}),(0,a.props.updateUserReview)()},a.onDescriptionChange=function(e){var t=e.target.value;a.setState(function(){return{description:t}}),(0,a.props.updateUserReview)()},a.onSave=function(){var e=a.state,t=e.username,n=e.description,r=a.props,i=r.userRating,c=r.userReview;a.props.saveUserReview({username:t||c.username,description:n||c.description,rating:i})},a.onClose=function(){var e=a.props,t=e.onClose;e.userReview.isSaved?t():Object(_.confirmAlert)({title:"",message:"Are you sure you want to close ?",buttons:[{label:"Exit and save your review",onClick:function(){a.onSave(),t()}},{label:"Exit without saving",onClick:function(){return t()}},{label:"Cancel",onClick:void 0}]})},a}return Object(B.a)(t,e),Object(M.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.visible,n=t.updateUserReview,r=t.userRating;!0===a&&r!==e.userRating&&n(),!1===a&&a!==e.visible&&this.setState(function(){return{username:"",description:""}})}},{key:"render",value:function(){var e=this.props,t=e.visible,a=void 0!==t&&t,n=e.userRating,r=e.userReview,i=e.renderUserRatingStars,o=this.state,s=o.username,l=o.description;return c.a.createElement(K,{visible:a,onClose:this.onClose,onSave:this.onSave},c.a.createElement("div",{className:"mt20 mb20 starsWrapper"},i()),c.a.createElement("div",{className:"ratingDescription"},function(e){switch(e){case 1:return"I hated it!";case 2:return"I didn't liked it";case 3:return"It was OK";case 4:return"I liked it!";case 5:return"I loved it!";default:return":o"}}(n)),c.a.createElement("hr",null),c.a.createElement("input",{className:"input",placeholder:"Your name",value:s||r.username||"",onChange:this.onUsernameChange}),c.a.createElement("hr",null),c.a.createElement("textarea",{className:"input",placeholder:"Add more details on your experience...",value:l||r.description||"",onChange:this.onDescriptionChange}))}}]),t}(i.Component)),q={updateUserReview:function(e){return{type:"reviews/UPDATE_USER_REVIEW",data:e}},saveUserReview:function(e){return{type:"reviews/SAVE_USER_REVIEW",data:e}}},Q=Object(l.b)(function(e){return{userReview:e.reviews.userReview}},q)($),ee=(a(125),"#ccc"),te="#fed801",ae=function(){var e="http://i.pravatar.cc/50?img=".concat(Math.floor(70*Math.random())+1);return c.a.createElement("img",{className:"avatar",src:e,alt:"avatar"})},ne=function(e){var t=e.username,a=e.rating,n=e.time,r=e.referral,i=e.review,o=e.onOpenModal;return c.a.createElement("div",{className:"flex"},c.a.createElement(ae,null),c.a.createElement("div",{className:"ml20"},c.a.createElement("div",{className:"heading username"},t||"Anonymous"),c.a.createElement("div",{className:"flex alignItemsCenter mb5"},c.a.createElement(P.a,{count:5,size:14,color1:ee,color2:te,half:!1,edit:!1,value:a}),c.a.createElement("span",{className:"secondaryText ml10"},function(e){var t=new Date,a=new Date("Z"!==A()(e.split(""))?"".concat(e,"Z"):e),n=(t.getTime()-a.getTime())/1e3;if(n<60)return"just now";if(n<3600)return"".concat(parseInt(n/60,10),"m ago");if(n<=86400)return"".concat(parseInt(n/3600,10),"h ago");var r=a.getDate(),i=V()(a.toDateString().match(/ [a-zA-Z]*/),"[0]","").replace(" ",""),c=a.getFullYear()===t.getFullYear()?"":" ".concat(a.getFullYear());return"".concat(r," ").concat(i).concat(c)}(n)," - ",r)),i?c.a.createElement("div",null,i):c.a.createElement("a",{href:null,onClick:o},"Describe your experience")))},re=function(e){function t(){var e,a;Object(F.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(Z.a)(this,(e=Object(H.a)(t)).call.apply(e,[this].concat(r)))).state={modalVisible:!1,userRating:0},a.onCloseModal=function(){return a.setState(function(){return{modalVisible:!1}})},a.onChangeRating=function(e){return a.setState(function(){return{modalVisible:!0,userRating:e}})},a.onOpenModal=function(){return a.setState(function(){return{modalVisible:!0}})},a.renderUserRatingStars=function(){return c.a.createElement(P.a,{count:5,onChange:a.onChangeRating,size:48,color1:ee,color2:te,half:!1,value:a.state.userRating})},a}return Object(B.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=e.companyData,n=e.userReview;if(null===a)return null;var r=t.reduce(function(e,t){return e+t.rating},0)/t.length,o=this.state,s=o.modalVisible,l=o.userRating;return c.a.createElement("div",{className:"container"},c.a.createElement(Q,{visible:s,onClose:this.onCloseModal,renderUserRatingStars:this.renderUserRatingStars,userRating:l}),c.a.createElement("h2",null,"Reviews"),c.a.createElement("div",{className:"generalRatingWrapper"},c.a.createElement("div",{className:"generalRating"},r.toFixed(1)),c.a.createElement("div",{className:"secondaryText ml20"},"from ",t.length," ratings"),c.a.createElement("div",{className:"viewReviewsHeaderWrapper"},c.a.createElement("a",{href:null},"View all reviews"))),c.a.createElement("hr",null),!1===n.apiSaved?c.a.createElement("div",{className:"flex"},c.a.createElement(ae,null),c.a.createElement("div",{className:"ml20"},c.a.createElement("div",{className:"heading"},"Rate and review"),c.a.createElement("div",{className:"secondaryText"},"Share your experience to help others"),this.renderUserRatingStars())):c.a.createElement("div",{className:"relative"},c.a.createElement(ne,{username:n.username,rating:n.rating,review:n.description,time:n.time,referral:n.referral,onOpenModal:this.onOpenModal}),c.a.createElement("span",{className:"editReview",onClick:this.onOpenModal},"...")),c.a.createElement("hr",null),c.a.createElement("div",{className:"mb20"},c.a.createElement("div",{className:"heading mb20"},"Latest reviews"),t.map(function(e,a){var n=e.id,r=e.username,o=e.rating,s=e.review,l=e.time,u=e.referral;return c.a.createElement(i.Fragment,{key:n},c.a.createElement(ne,{username:r,rating:o,review:s,time:l,referral:u}),a!==t.length-1&&c.a.createElement("hr",null))})),c.a.createElement("div",{className:"viewReviewsFooterWrapper"},c.a.createElement("a",{href:null},"View all reviews")))}}]),t}(i.Component),ie=Object(l.b)(function(e){var t=e.reviews,a=t.data,n=t.userReview;return{data:a,companyData:e.company.data,userReview:n}})(re),ce=(a(126),function(e){function t(){return Object(F.a)(this,t),Object(Z.a)(this,Object(H.a)(t).apply(this,arguments))}return Object(B.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"App"},c.a.createElement(Y,null),c.a.createElement(ie,null))}}]),t}(i.Component)),oe=Object(m.a)(),se=Object(u.createStore)(f,Object(v.composeWithDevTools)(Object(u.applyMiddleware)(oe)));oe.run(W);var le=function(){return c.a.createElement(l.a,{store:se},c.a.createElement(ce,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},71:function(e,t,a){e.exports=a(127)},76:function(e,t,a){}},[[71,1,2]]]);
//# sourceMappingURL=main.618a598d.chunk.js.map